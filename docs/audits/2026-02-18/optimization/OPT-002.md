# [OPT-002]: Cache Hit/Miss Metrics

## Impact
LOW

## Category
Observability

## Location
- File: `packages/core/src/services/APIService.ts` (Universalis API cache)
- File: `apps/universalis-proxy/src/index.ts` (proxy-level cache)

## Current Performance
The APIService implements a sophisticated caching layer with version checking, checksum validation, and TTL enforcement. The universalis-proxy also caches responses at the edge. However, neither system reports cache hit/miss metrics, making it difficult to:

1. Understand cache effectiveness
2. Tune TTL values
3. Detect cache-busting attacks
4. Optimize cache capacity

## Bottleneck Analysis
Without metrics, it's impossible to know if the cache is actually saving API calls or if TTLs are too aggressive/conservative.

## Proposed Optimization
```typescript
// Add simple counters to the cache
interface CacheMetrics {
  hits: number;
  misses: number;
  evictions: number;
  errors: number;
  lastReset: number;
}

// Log periodically or expose via health endpoint
logger.info('Cache metrics', {
  hitRate: `${(metrics.hits / (metrics.hits + metrics.misses) * 100).toFixed(1)}%`,
  totalRequests: metrics.hits + metrics.misses,
});
```

## Expected Improvement
- Visibility into cache effectiveness
- Data-driven TTL tuning
- Early warning for cache-busting patterns

## Trade-offs
- Small memory overhead for counters
- Slight code complexity increase
- Need to decide on metrics reporting interval

## Benchmark Approach
- Deploy with metrics enabled
- Monitor hit rate over 24-48 hours
- Compare Universalis API call volume before/after cache tuning
