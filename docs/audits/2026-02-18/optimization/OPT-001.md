# [OPT-001]: Category Cache Refresh on Updates

## Impact
MEDIUM

## Category
Caching

## Location
- File: `apps/presets-api/src/handlers/categories.ts`
- Function: Category cache with 1-minute TTL

## Current Performance
The presets-api caches valid categories from the database with a 1-minute TTL. When categories are created or updated, the cache is not explicitly invalidated â€” it relies on TTL expiry. This means:

- New categories take up to 60 seconds to appear in validation
- Deleted categories remain valid for up to 60 seconds
- During this window, presets could be submitted to stale categories

## Bottleneck Analysis
For a small dye tool application, this is rarely a problem. Categories change infrequently (maybe once per game patch). However, the pattern is worth improving as a best practice.

## Proposed Optimization
```typescript
// Add explicit cache invalidation on category mutations
async function invalidateCategoryCache() {
  categoryCache = null;
  categoryCacheTimestamp = 0;
}

// Call after category create/update/delete operations
await createCategory(data);
invalidateCategoryCache();
```

## Expected Improvement
- Immediate consistency after category changes (from 0-60s delay to 0s)
- No performance cost (cache is rebuilt on next request)

## Trade-offs
- Slightly more code complexity
- Negligible impact for the current use case (categories rarely change)

## Benchmark Approach
- Create a category, immediately submit a preset with that category
- Measure time until the new category is accepted
