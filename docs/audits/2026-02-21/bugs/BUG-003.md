# BUG-003: Discord Rate Limit Response Uses HTTP 429 Instead of 200

## Severity
CRITICAL

## Type
Protocol Error

## Location
- File: `apps/moderation-worker/src/utils/response.ts`
- Line(s): ~309
- Function: Rate limit response handler

## Description
When the moderation worker rate-limits a user, it returns an HTTP `429 Too Many Requests` status with an ephemeral message body. However, Discord's HTTP Interactions API **requires** all interaction responses to use HTTP `200`. Non-200 responses cause Discord to silently discard the response body, meaning the user never sees the rate limit message. Discord may also retry the interaction, creating a feedback loop.

## Evidence
```typescript
// response.ts
return new Response(JSON.stringify({
  type: InteractionResponseType.ChannelMessageWithSource,
  data: {
    content: 'You are being rate limited. Please try again later.',
    flags: MessageFlags.Ephemeral,
  },
}), {
  status: 429,  // ← Discord ignores non-200 responses!
  headers: { 'Content-Type': 'application/json' },
});
```

## Reproduction Scenario
1. A moderator triggers a command rapidly
2. Rate limiter kicks in
3. Worker returns HTTP 429 with an ephemeral error message
4. Discord discards the 429 response body
5. User sees either nothing or a generic "interaction failed" error
6. Discord may retry, causing more rate limit hits

## Suggested Fix
Return HTTP 200 with the ephemeral rate limit message:

```typescript
return new Response(JSON.stringify({
  type: InteractionResponseType.ChannelMessageWithSource,
  data: {
    content: 'You are being rate limited. Please try again later.',
    flags: MessageFlags.Ephemeral,
  },
}), {
  status: 200,  // ← Discord requires 200 for interaction responses
  headers: { 'Content-Type': 'application/json' },
});
```

## Why It's Hidden
Using HTTP 429 for rate limiting is intuitive from a REST API perspective. The Discord-specific requirement for HTTP 200 on all interaction responses is easy to overlook, and the silent discarding of the response body means no error is thrown — the response just vanishes.
