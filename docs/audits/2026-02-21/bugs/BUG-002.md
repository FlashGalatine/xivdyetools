# BUG-002: `safeParseJSON` Prototype Pollution Check Always False-Positives

## Severity
CRITICAL

## Type
Logic Error

## Location
- File: `apps/moderation-worker/src/utils/safe-json.ts`
- Line(s): ~205
- Function: `safeParseJSON`

## Description
The prototype pollution detection in `safeParseJSON` uses `if (key in obj)` which checks the prototype chain. Since `'constructor' in {}` is always `true` in JavaScript (inherited from `Object.prototype`), this check falsely detects prototype pollution on **every valid object**, potentially rendering the moderation worker non-functional for any code paths that reach this function.

## Evidence
```typescript
// The check:
if (key in obj) {  // ← checks prototype chain, not own properties!
  // triggers for 'constructor', 'toString', etc.
}
```

In JavaScript:
```javascript
'constructor' in {}  // → true (always!)
'__proto__' in {}    // → true (always!)
```

## Reproduction Scenario
Any Discord interaction body parsed through `safeParseJSON` that contains legitimate JSON objects could be rejected as "prototype pollution detected." This would cause the moderation worker to fail to process valid requests.

## Suggested Fix
Use `Object.hasOwn(obj, key)` or `obj.hasOwnProperty(key)` instead of `key in obj`:

```typescript
if (Object.hasOwn(obj, key)) {
  // Genuine prototype pollution — only triggers on OWN properties
}
```

## Why It's Hidden
This likely wasn't caught because:
1. The function may not be on the main code path (interaction bodies may be parsed elsewhere)
2. Tests may not have used objects with standard prototype chain
3. The false positive may be handled by a catch block that silently falls back
